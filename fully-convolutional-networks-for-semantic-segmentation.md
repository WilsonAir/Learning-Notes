# Fully Convolutional Networks for Semantic Segmentation

**7、Fully Convolutional Networks for Semantic Segmentation**

卷积网络是强大的可视化模型，可以产生特征层次结构。我们展示了卷积网络本身，训练端到端，像素到像素，超过了语义分割的最新技术水平。

我们的主要观点是构建“完全卷积”网络，该网络接受任意大小的输入并通过有效的推理和学习产生相应大小的输出。

我们定义并详细说明了FCN的空间结构，解释它们在空间密集预测任务中的应用，并绘制与先前模型的连接。

我们采用当下流行的分类网络（AlexNet \[20\]，VGG网络\[31\]和GoogLeNet \[32\]）整合进完全卷积网络，并通过微调\[3\]将其学习的表示转移到分割任务。

然后，我们定义了一种skip架构，它将来自深层粗糙层的**语义信息**与来自浅层精细层的**外观信息**相结合，以生成准确而精细的分割。

我们的完全卷积网络实现了PASCAL VOC的最新分割（相对改进率为20％，2012年平均IU为62.2％），NYUDv2和SIFT流量，而典型情况下推理时间不到五分之一秒图片。

introduction

卷积网络正在推动识别的进步。 Convnet不仅改善了整体图像分类\[20,31,32\]，而且还在包含结构化输出的本地任务上取得进展。其中包括边界框对象检测\[29,10,17\]，部分和关键点预测\[39,24\]以及局部对应\[24,8\]的进展。

从粗略推断到精细推理的下一步自然是对每个像素进行预测。先前的方法已经使用了用于语义分割的网络\[27,2,7,28,15,13,​​9\]，其中每个像素用其封闭对象或区域的类来标记，但是具有该工作所解决的缺点。

我们表明，完全卷积网络（FCN）训练端到端，像素到像素的语义分割超过了最先进的，没有进一步的机制。据我们所知，这是第一个端对端训练FCN（1）用于像素预测和（2）从监督预训练的工作。现有网络的完全卷积版本预测来自任意大小输入的密集输出。学习和推理都是通过密集的前馈计算和反向传播在整个图像时进行的。网内上采样层通过子采样池实现网络中的像素预测和学习。

这种方法无论是渐近还是绝对都是有效的，并且排除了对其他工作中的复杂性的需要。 Patchwise训练很常见\[27,2,7,28,9\]，但缺乏完全卷积训练的效率。我们的方法没有利用预处理和后处理的复杂性，包括超像素\[7,15\]，proposal\[15,13\]，或随机场或局部分类器的事后细化\[7,15\]。我们的模型通过将分类网络重新解释为完全卷积的同时从他们学习到的表达中进行微调，将最近在分类\[20,31,32\]中的比较成功的网络转移到密集预测。相比之下，以前的作品在没有受过监督的预训练的情况下应用了小型卷积\[7,28,27\]。

语义分割面临语义和位置之间的内在张力：**全局信息**解决了是什么 而 **局部信息**解决在何处的问题。

深度特征层次结构**在非线性局部到全局的金字塔** 中编码位置和语义。

我们定义了一个**Skip架构**以利用这个特征谱，它结合了**深度**，**粗略**，**语义信息**和第4.2节中的**浅层**，**精细**的**外观信息**（参见图3）。

在接下一节中，我们将回顾有关深度分类网络，FCN以及使用卷积网络进行语义分割的最新方法的相关工作。

而后的部分介绍了FCN设计和密集预测权衡，介绍了我们的网络上采样和多层组合的架构，并描述了我们的实验框架。

最后，我们展示了PASCAL VOC 2011-2，NYUDv2和SIFT Flow的最新成果。

相关工作：

我们的方法建立在 最近成功的深层次网络上，这些网络进行图像分类\[20,31,32\]和迁移学习\[3,38\]。迁移学习首先应用在各种视觉识别任务\[3,38\]，然后在检测上，以及在混合proposal 分类器模型 基础上的instance和语义分割\[10,15,13\]。我们现在重新构建和微调分类网络，以直接，密集地预测语义分割块。我们绘制了FCN的空间结构，并在此框架中定位了历史和近期的先前模型。

**全卷积网络FCN ：**据我们所知，将一个卷积网络扩展到任意大小的输入的想法首先出现在Matan等人的脑海中\[26\]，它扩展了经典的LeNet \[21\]以识别数字串。因为他们的网络仅限于一维输入字符串，Matan等人使用Viterbi解码来获得它们的输出。 Wolf和Platt \[37\]将信号输出扩展为邮政地址块四个角的检测分数的二维图。这两个历史性的工作都推理和学习了检测工作中的全卷积性，以便进行检测。宁等人 \[27\]定义了一个基于全卷积预测的秀丽隐杆线虫组织的粗多类分割的预测网。

在当前的多层网络时代，全卷积计算也被充分探索。 Sermanet等人的滑动窗口检测\[29\]，Pinheiro和Collobert \[28\]的语义分割，以及Eigen等人的图像恢复\[4\]，做完全卷积推理。完全卷积训练很少见，但Tompson等人 \[35\]有效地使用了它来学习一个端到端部分探测器以及应用到姿势估计的空间模型，尽管他们没有在这个方法上进行解释或分析。

He等人\[17\]丢弃分类网的非卷积部分以制作特征提取器。它们结合了proposal和空间金字塔池化，以产生用于分类的本地化固定长度特征。虽然快速有效，但这种混合模式无法端到端地学习。

**用convnet进行密集预测**

最近的一些研究已经将convnet应用于密集预测问题，包括Ning \[27\]，Farabet等 \[7\]，Pinheiro和Collobert \[28\] 等人的语义分割; Ciresan等人\[2\]的电子显微镜边界预测。 和Ganin和Lempitsky \[9\]的混合信号/最近邻模型的自然图像;和Eigen \[4,5\]等人的图像恢复和深度估计。这些方法的共同要素包括：

•限制容量和感受野的小模型;

•补丁训练\[27,2,7,28,9\];

•通过超像素投影，随机场正则化，滤波或局部分类进行后处理\[7,2,9\];

•密集输出的输入移位和输出交错\[29,28,9\];

•多尺度金字塔处理\[7,28,9\];

•饱和tanh非线性\[7,4,28\];

•合奏\[2,9\]，

而我们的方法没有这种机制。然而，我们从FCN的角度研究了补丁训练3.4和“移位 - 缝合”密集输出3.2。我们还讨论了网络上采样3.3，其中Eigen等人 \[5\] 的完全连接预测是一个特例。

与这些现有方法不同，我们采用图像分类作为监督预训练，并微调完全卷积，以便从整个图像输入和Ground Truth中简单有效地进行调整和扩展深度分类体系结构。

Hariharan等人\[15\]和Gupta等人\[13\]同样使深度分类网适应语义分割，却应用到混合 proposal - 分类器模型中。这些方法通过对检测，语义分割和实例分割的边界框和/或区域提议进行采样来微调R-CNN系统\[10\]。但是这两种方法都不是端到端学习的。他们分别在PASCAL VOC和NYUDv2上实现了最先进的分割结果，因此我们直接将我们独立的端到端FCN与他们的语义分割结果在第5节中进行比较。

我们融合各层的特征以定义非线性局部 - 全局表达，并调整为端到端。在当代作品中Hariharan等 \[16\]也在他们的混合模型中使用多个层进行语义分割。

有点难～

[https://www.cnblogs.com/xuanxufeng/p/6249834.html](https://www.cnblogs.com/xuanxufeng/p/6249834.html)

